
分析テーマ
- Cowrieが攻撃回数多いし、実行されたコマンドも取得できているので、コマンドの分析なども面白そう
	- それぞれのセッションは何分続いているのかと平均時間
		- eventIDが、"cowrie.command.input"が見つかったら、sessionの値と"timestamp"の値を一時的に保存しておいて、次にそのsessionの値の一番遅いtimestampを探して、それぞれのTimestampから何分セッションが続いているのかをcsvに保存して、降順で| session | src_ip | while_session | の形で保存する
	- ログインを試みたが、諦める攻撃者
		- ログインの失敗回数が1以上で、コマンド入力回数が0の攻撃者と定義
![](https://lh7-rt.googleusercontent.com/slidesz/AGV_vUcslAhC8H8LKfg3Vb-A_x0BOOoZdqCzXI8xbGSQ7ZpxCVk6ETwpLCIdWtyE4lt4GoVM9Zxx8FLUksWlJVUNOdhju-yWaNW7uNdqwBhxsrKy-9D3DTvrm0RElzmlgZFCaR03uzLo=s2048?key=QwsF8cxdSVnQafXbRIVP-Dpg "グラフ")
- ログインの失敗回数
	- 全リージョン
	- 最大試行回数 25回
	- 最小試行回数 1回
	- ログイン失敗し、諦めるユーザーの滞在時間は、数秒~2分
		- 0.07分などの数秒でもログイン失敗回数が多い攻撃者もいる
			- ブルートフォース
		- 2分滞在時間でも2回とか数回しかログイン失敗回数がない攻撃者は
			- 手打ちか、ブルートフォースの間隔を開けている可能性
			- 検知や、ipブロックを防ぐため？

- ログイン失敗してるIPに対する調査


- ログインはブルートフォースツールが動いていると予想
- 下を見てもありそうなパスワードとユーザー名を片っ端から試してたまたまログインできている
- タイムスタンプを見てもそれぞれのログイン試行の間隔は、約0.8秒とか
```
{"eventid":"cowrie.session.connect","src_ip":"186.237.151.200","src_port":54936,"dst_ip":"172.30.0.2","dst_port":23,"session":"e6c877b5bb81","protocol":"telnet","message":"New connection: 186.237.151.200:54936 (172.30.0.2:23) [session: e6c877b5bb81]","sensor":"074f3d3fa4df","timestamp":"2025-01-26T00:48:05.513755Z"}

{"eventid":"cowrie.login.failed","username":"root","password":"Fireitup","message":"login attempt [root/Fireitup] failed","sensor":"074f3d3fa4df","timestamp":"2025-01-26T00:48:06.176232Z","src_ip":"186.237.151.200","session":"e6c877b5bb81"}

{"eventid":"cowrie.login.failed","username":"root","password":"adminpassword","message":"login attempt [root/adminpassword] failed","sensor":"074f3d3fa4df","timestamp":"2025-01-26T00:48:06.879027Z","src_ip":"186.237.151.200","session":"e6c877b5bb81"}

{"eventid":"cowrie.login.failed","username":"ubnt","password":"ubnt","message":"login attempt [ubnt/ubnt] failed","sensor":"074f3d3fa4df","timestamp":"2025-01-26T00:48:07.623336Z","src_ip":"186.237.151.200","session":"e6c877b5bb81"}

{"eventid":"cowrie.login.failed","username":"admin","password":"12345","message":"login attempt [admin/12345] failed","sensor":"074f3d3fa4df","timestamp":"2025-01-26T00:48:08.339216Z","src_ip":"186.237.151.200","session":"e6c877b5bb81"}

{"eventid":"cowrie.login.success","username":"supervisor","password":"12345","message":"login attempt [supervisor/12345] succeeded","sensor":"074f3d3fa4df","timestamp":"2025-01-26T00:48:09.095527Z","src_ip":"186.237.151.200","session":"e6c877b5bb81"}
```







- Dionaeaで収集したマルウェアの分析
- それぞれのリージョンの攻撃元の国について

